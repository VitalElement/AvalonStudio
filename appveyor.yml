version: 1.0.0.{build}
before_build:
- cmd: >-
    git submodule update --init --recursive



build_script:

- ps: .\download.ps1 "https://www.dropbox.com/s/k1bzo926nod5r55/libskia.so?dl=0" "C:\projects\avalonstudio\AvalonStudio\AvalonStudio\AvalonStudio\bin\Release\netcoreapp1.1\ubuntu.14.04-x64\publish\libskia.so"
- ps: .\download.ps1 "https://www.dropbox.com/s/sw9ilb6d8uivqo9/libSkiaSharp.so?dl=0" "C:\projects\avalonstudio\AvalonStudio\AvalonStudio\AvalonStudio\bin\Release\netcoreapp1.1\ubuntu.14.04-x64\publish\libSkiaSharp.dylib.so"


after_build:
- cmd: 7z a -r AvalonStudio-win7-x64.zip %APPVEYOR_BUILD_FOLDER%\AvalonStudio\AvalonStudio\bin\Release\netcoreapp1.1\win7-x64\publish\*.*
- cmd: 7z a -r AvalonStudio-ubuntu.14.04-x64.zip %APPVEYOR_BUILD_FOLDER%\AvalonStudio\AvalonStudio\bin\Release\netcoreapp1.1\ubuntu.14.04-x64\publish\*.*
- cmd: 7z a -r AvalonStudio-debian.8-x64.zip %APPVEYOR_BUILD_FOLDER%\AvalonStudio\AvalonStudio\bin\Release\netcoreapp1.1\debian.8-x64\publish\*.*
- cmd: 7z a -r AvalonStudio-osx.10.12-x64.zip %APPVEYOR_BUILD_FOLDER%\AvalonStudio\AvalonStudio\bin\Release\netcoreapp1.1\osx.10.12-x64\publish\*.*

artifacts:
- path: AvalonStudio-win7-x64.zip
- path: AvalonStudio-ubuntu.14.04-x64.zip
- path: AvalonStudio-debian.8-x64.zip
- path: AvalonStudio-osx.10.12-x64.zip

deploy:
- provider: Environment
  name: FastRing
  on:
    branch: master
    APPVEYOR_REPO_TAG: true
notifications:
- provider: Webhook
  url: https://webhooks.gitter.im/e/e8ce2449e773a183903b
  method: POST
  on_build_success: true
  on_build_failure: true
  on_build_status_changed: true